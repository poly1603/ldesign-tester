# @ldesign/tester ä½¿ç”¨æŒ‡å—

> ğŸ§ª ä¼ä¸šçº§æµ‹è¯•å·¥å…·é›† - ä¸€é”®ç”Ÿæˆæµ‹è¯•ã€Mockã€é…ç½®å’ŒCI/CD

## ğŸ“¦ è¿™ä¸ªåŒ…æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ

@ldesign/tester æ˜¯ä¸€ä¸ª**å®Œæ•´çš„æµ‹è¯•è§£å†³æ–¹æ¡ˆ**ï¼Œå®ƒèƒ½å¸®ä½ ï¼š

1. **è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ä»£ç ** - å•å…ƒæµ‹è¯•ã€E2Eæµ‹è¯•ã€ç»„ä»¶æµ‹è¯•ã€APIæµ‹è¯•
2. **ç”ŸæˆMockæ•°æ®** - Faker.jså‡æ•°æ® + MSW API Mock
3. **ç”Ÿæˆæµ‹è¯•é…ç½®** - Vitest/Playwrighté›¶é…ç½®å¯åŠ¨
4. **ç”ŸæˆCI/CDé…ç½®** - GitHub Actions/GitLab CI/Jenkinsæ¨¡æ¿
5. **æ€§èƒ½å’Œè§†è§‰æµ‹è¯•** - Benchmark/å‹åŠ›æµ‹è¯•/Screenshotå¯¹æ¯”

**ç®€å•æ¥è¯´**ï¼šä¸ç”¨æ‰‹å†™æµ‹è¯•ä»£ç å’Œé…ç½®ï¼Œå…¨éƒ¨è‡ªåŠ¨ç”Ÿæˆï¼

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### 1. å®‰è£…

```bash
pnpm add -D @ldesign/tester
```

### 2. åˆå§‹åŒ–

```bash
npx ldesign-test init
```

è¿™ä¼šè‡ªåŠ¨ï¼š
- âœ… ç”Ÿæˆ `vitest.config.ts`
- âœ… ç”Ÿæˆ `tests/setup.ts`
- âœ… ç”Ÿæˆ `tsconfig.test.json`

### 3. ç”Ÿæˆæµ‹è¯•

```bash
# ä¸ºå‡½æ•°ç”Ÿæˆå•å…ƒæµ‹è¯•
npx ldesign-test generate unit UserService

# ä¸ºVueç»„ä»¶ç”Ÿæˆæµ‹è¯•
npx ldesign-test generate component Button --framework vue

# ä¸ºReactç»„ä»¶ç”Ÿæˆæµ‹è¯•
npx ldesign-test generate component Button --framework react
```

## ğŸ¯ ä¸»è¦åŠŸèƒ½

### 1. æµ‹è¯•ç”Ÿæˆ

#### å•å…ƒæµ‹è¯•

```bash
npx ldesign-test generate unit utils/format
```

ç”Ÿæˆçš„æµ‹è¯•åŒ…å«ï¼š
- âœ… åŸºæœ¬åŠŸèƒ½æµ‹è¯•
- âœ… è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- âœ… é”™è¯¯å¤„ç†æµ‹è¯•

#### Vueç»„ä»¶æµ‹è¯•

```bash
npx ldesign-test generate component MyButton --framework vue
```

ç”Ÿæˆçš„æµ‹è¯•åŒ…å«ï¼š
- âœ… ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- âœ… Propsæµ‹è¯•
- âœ… äº‹ä»¶æµ‹è¯•
- âœ… æ’æ§½æµ‹è¯•

#### Reactç»„ä»¶æµ‹è¯•

```bash
npx ldesign-test generate component MyButton --framework react
```

ç”Ÿæˆçš„æµ‹è¯•åŒ…å«ï¼š
- âœ… ç»„ä»¶æ¸²æŸ“æµ‹è¯•
- âœ… Propsæµ‹è¯•
- âœ… ç”¨æˆ·äº¤äº’æµ‹è¯•
- âœ… Childrenæµ‹è¯•

#### E2Eæµ‹è¯•

```bash
npx ldesign-test generate e2e login
```

ç”Ÿæˆçš„æµ‹è¯•åŒ…å«ï¼š
- âœ… é¡µé¢åŠ è½½æµ‹è¯•
- âœ… ç”¨æˆ·äº¤äº’æµ‹è¯•
- âœ… è¡¨å•æäº¤æµ‹è¯•

### 2. Mockç³»ç»Ÿ

#### ç”ŸæˆFakerå‡æ•°æ®

```bash
# ç”Ÿæˆ10ä¸ªç”¨æˆ·
npx ldesign-test mock faker --type user --count 10

# ç”Ÿæˆ20ä¸ªäº§å“
npx ldesign-test mock faker --type product --count 20

# ç”Ÿæˆè®¢å•æ•°æ®
npx ldesign-test mock faker --type order --count 15
```

#### ç”ŸæˆMSW API Mock

```bash
# ä¸ºusersèµ„æºç”ŸæˆCRUD handlers
npx ldesign-test mock msw --resource users

# è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶
npx ldesign-test mock msw --resource posts --output src/mocks/posts.ts
```

#### ç¼–ç¨‹æ–¹å¼ä½¿ç”¨

```typescript
import { createMockGenerator } from '@ldesign/tester'

const mockGen = createMockGenerator()

// ç”Ÿæˆç”¨æˆ·æ•°æ®
const users = mockGen.generateCommonData('user', 10, 'zh_CN')

// ç”Ÿæˆäº§å“æ•°æ®
const products = mockGen.generateCommonData('product', 20)
```

### 3. é…ç½®ç”Ÿæˆ

#### Vitesté…ç½®

```bash
npx ldesign-test config vitest --coverage
```

ç”ŸæˆåŒ…å«ï¼š
- âœ… æµ‹è¯•ç¯å¢ƒé…ç½®ï¼ˆjsdomï¼‰
- âœ… è¦†ç›–ç‡é…ç½®ï¼ˆv8ï¼‰
- âœ… Vue/Reactæ’ä»¶é…ç½®

#### Playwrighté…ç½®

```bash
npx ldesign-test config playwright
```

ç”ŸæˆåŒ…å«ï¼š
- âœ… å¤šæµè§ˆå™¨é…ç½®ï¼ˆChrome/Firefox/Safariï¼‰
- âœ… ç§»åŠ¨ç«¯é…ç½®
- âœ… æˆªå›¾/å½•å±é…ç½®

### 4. CI/CDé›†æˆ

#### GitHub Actions

```bash
npx ldesign-test ci github --node-versions 18,20 --coverage
```

ç”Ÿæˆ `.github/workflows/test.yml`ï¼ŒåŒ…å«ï¼š
- âœ… å¤šNodeç‰ˆæœ¬çŸ©é˜µæµ‹è¯•
- âœ… è¦†ç›–ç‡ä¸Šä¼ åˆ°Codecov
- âœ… æµ‹è¯•ç»“æœArtifacts

#### GitLab CI

```bash
npx ldesign-test ci gitlab
```

ç”Ÿæˆ `.gitlab-ci.yml`ï¼ŒåŒ…å«ï¼š
- âœ… Pipelineé…ç½®
- âœ… è¦†ç›–ç‡æŠ¥å‘Š
- âœ… GitLab Pageséƒ¨ç½²

#### Jenkins

```bash
npx ldesign-test ci jenkins
```

ç”Ÿæˆ `Jenkinsfile`ï¼ŒåŒ…å«ï¼š
- âœ… å£°æ˜å¼Pipeline
- âœ… HTMLæŠ¥å‘Šå‘å¸ƒ

### 5. æ€§èƒ½æµ‹è¯•

#### åŸºå‡†æµ‹è¯•

```typescript
import { createBenchmarkTester } from '@ldesign/tester'

const tester = createBenchmarkTester()

tester
  .add({
    name: 'Array.forEach',
    fn: () => { /* ... */ },
  })
  .add({
    name: 'for loop',
    fn: () => { /* ... */ },
  })

const results = await tester.run()
console.log(tester.formatResults(results))
```

è¾“å‡ºï¼š
```
ğŸ“Š åŸºå‡†æµ‹è¯•ç»“æœ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Array.forEach
   âš¡ Ops/sec: 1,234,567.89
   â±ï¸  å¹³å‡è€—æ—¶: 0.0008ms
   
2. for loop
   âš¡ Ops/sec: 2,345,678.90
   â±ï¸  å¹³å‡è€—æ—¶: 0.0004ms

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

#### å‹åŠ›æµ‹è¯•

```typescript
import { createLoadTester } from '@ldesign/tester'

const loadTester = createLoadTester()

const result = await loadTester.runLoadTest({
  url: 'http://localhost:3000/api/users',
  connections: 100,
  duration: 30,
})

console.log(loadTester.formatResult(result))
```

#### Lighthouseæµ‹è¯•

```typescript
import { createLighthouseTester } from '@ldesign/tester'

const lighthouse = createLighthouseTester()

const result = await lighthouse.runLighthouse({
  url: 'https://example.com',
  formFactor: 'mobile',
})

console.log(lighthouse.formatResult(result))
```

### 6. è§†è§‰å›å½’æµ‹è¯•

#### Screenshotå¯¹æ¯”

```typescript
import { createVisualRegression } from '@ldesign/tester'

const visualRegression = createVisualRegression()

test('visual regression', async ({ page }) => {
  await page.goto('https://example.com')
  
  const result = await visualRegression.captureAndCompare(
    page,
    'homepage',
  )
  
  expect(result.hasDiff).toBe(false)
})
```

#### Percyé›†æˆ

```typescript
import { createPercyIntegration } from '@ldesign/tester'

const percy = createPercyIntegration()

test('percy snapshot', async ({ page }) => {
  await page.goto('https://example.com')
  
  await percy.snapshot(page, {
    name: 'Homepage',
    widths: [375, 768, 1280],
  })
})
```

## ğŸ“Š Dashboard

### å¯åŠ¨Dashboard

```bash
npx ldesign-test dashboard --port 3000
```

è®¿é—® `http://localhost:3000` æŸ¥çœ‹ï¼š
- æµ‹è¯•è¿è¡Œå†å²
- è¦†ç›–ç‡è¶‹åŠ¿
- å¤±è´¥ç”¨ä¾‹è¿½è¸ª
- æ€§èƒ½ç»Ÿè®¡

### ç¼–ç¨‹æ–¹å¼

```typescript
import { createDashboardServer, createTestDatabase } from '@ldesign/tester'

const db = createTestDatabase()
const runId = db.saveTestRun(results, coverage)

const dashboard = createDashboardServer({ port: 3000 })
await dashboard.start()
```

## ğŸ”§ æ‰€æœ‰CLIå‘½ä»¤

```bash
# åˆå§‹åŒ–
npx ldesign-test init [--framework vue|react] [--coverage] [--e2e]

# ç”Ÿæˆè„šæ‰‹æ¶
npx ldesign-test scaffold

# ç”Ÿæˆæµ‹è¯•
npx ldesign-test generate unit <name>
npx ldesign-test generate component <name> --framework vue|react
npx ldesign-test generate e2e <feature>
npx ldesign-test generate api <name>
npx ldesign-test generate integration <name>

# Mock
npx ldesign-test mock faker --type user|product|order [--count 10] [--locale zh_CN|en_US]
npx ldesign-test mock msw --resource <name> [--output <path>]

# é…ç½®
npx ldesign-test config vitest [--coverage]
npx ldesign-test config playwright

# CI/CD
npx ldesign-test ci github [--node-versions 18,20] [--coverage]
npx ldesign-test ci gitlab
npx ldesign-test ci jenkins
npx ldesign-test ci circleci

# æ€§èƒ½
npx ldesign-test benchmark [files...]

# Dashboard
npx ldesign-test dashboard [--port 3000]

# è¦†ç›–ç‡
npx ldesign-test coverage [--threshold 80]
```

## ğŸ“– å®Œæ•´API

### TestGenerator

```typescript
import { createTestGenerator } from '@ldesign/tester'

const generator = createTestGenerator()

// å•å…ƒæµ‹è¯•
const unitTest = generator.generateUnitTest('UserService')

// ç»„ä»¶æµ‹è¯•
const vueTest = generator.generateComponentTest('Button', 'vue')
const reactTest = generator.generateComponentTest('Button', 'react')

// E2Eæµ‹è¯•
const e2eTest = generator.generateE2ETest('login')

// APIæµ‹è¯•
const apiTest = generator.generateAPITest('users')
```

### ConfigGenerator

```typescript
import { createConfigGenerator } from '@ldesign/tester'

const configGen = createConfigGenerator()

// Vitesté…ç½®
const vitestConfig = configGen.generateVitestConfig({
  environment: 'jsdom',
  coverage: { provider: 'v8' },
})

// Playwrighté…ç½®
const playwrightConfig = configGen.generatePlaywrightConfig({
  baseURL: 'http://localhost:3000',
})
```

### MockGenerator

```typescript
import { createMockGenerator } from '@ldesign/tester'

const mockGen = createMockGenerator()

// Fakeræ•°æ®
const users = mockGen.generateCommonData('user', 10, 'zh_CN')

// MSW Handler
const handler = mockGen.generateMSWHandler({
  method: 'GET',
  path: '/api/users',
  response: users,
})
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é¡¹ç›®ç»“æ„

```
your-project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ utils/
â”‚   â””â”€â”€ api/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/           # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/    # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ helpers/        # æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ fixtures/       # æµ‹è¯•æ•°æ®
â”‚   â””â”€â”€ mocks/          # Mockæ–‡ä»¶
â”œâ”€â”€ e2e/                # E2Eæµ‹è¯•
â”œâ”€â”€ vitest.config.ts
â””â”€â”€ playwright.config.ts
```

### 2. package.jsonè„šæœ¬

```json
{
  "scripts": {
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest run --coverage",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "dashboard": "ldesign-test dashboard"
  }
}
```

### 3. Gitå¿½ç•¥

```gitignore
# æµ‹è¯•ç›¸å…³
coverage/
test-results/
playwright-report/
.nyc_output/
test-history.db
```

## â“ å¸¸è§é—®é¢˜

### Q: æ”¯æŒå“ªäº›æµ‹è¯•æ¡†æ¶ï¼Ÿ

A: ä¸»è¦æ”¯æŒ Vitestï¼ˆå•å…ƒ/ç»„ä»¶ï¼‰å’Œ Playwrightï¼ˆE2Eï¼‰ï¼Œä¹Ÿæ”¯æŒJestï¼ˆé€šè¿‡å…¼å®¹APIï¼‰ã€‚

### Q: æ”¯æŒå“ªäº›å‰ç«¯æ¡†æ¶ï¼Ÿ

A: Vue 3 å’Œ React 18+ã€‚

### Q: å¯ä»¥è‡ªå®šä¹‰ç”Ÿæˆçš„æµ‹è¯•ä»£ç å—ï¼Ÿ

A: å¯ä»¥ï¼Œé€šè¿‡é…ç½®é€‰é¡¹æˆ–è€…ä¿®æ”¹ç”Ÿæˆåçš„ä»£ç ã€‚

### Q: Mockæ•°æ®æ”¯æŒå“ªäº›ç±»å‹ï¼Ÿ

A: æ”¯æŒ30+å­—æ®µç±»å‹ï¼ŒåŒ…æ‹¬nameã€emailã€phoneã€addressã€uuidã€dateç­‰ã€‚

### Q: CI/CDæ¨¡æ¿å¯ä»¥ä¿®æ”¹å—ï¼Ÿ

A: å¯ä»¥ï¼Œç”Ÿæˆåå¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [Vitest](https://vitest.dev/)
- [Playwright](https://playwright.dev/)
- [Faker.js](https://fakerjs.dev/)
- [MSW](https://mswjs.io/)
- [å®Œæ•´æ–‡æ¡£](./docs/)

## ğŸ“„ License

MIT Â© LDesign Team

---

**ä¸€å¥è¯æ€»ç»“**ï¼š@ldesign/tester = æµ‹è¯•ç”Ÿæˆ + Mockç³»ç»Ÿ + é…ç½®ç”Ÿæˆ + CI/CDæ¨¡æ¿ + æ€§èƒ½æµ‹è¯• + è§†è§‰å›å½’ + Dashboard

**æ ¸å¿ƒä»·å€¼**ï¼šè®©ä½ å†™æ›´å°‘çš„æµ‹è¯•ä»£ç ï¼Œå¾—åˆ°æ›´å¥½çš„æµ‹è¯•è¦†ç›–ç‡ï¼ğŸš€



